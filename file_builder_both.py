import mysql.connector

for year in range(2013,2014):
	cnx = mysql.connector.connect(user='root',password='Louis and Marie',database='baseball')
	cursor = cnx.cursor()
	query = ("select 'name','retroid','hbp_pct','nonhbp_pct','noncontact_per_nonhbp_pct','contact_per_nonhbp_pct','K_per_noncontact_pct','bb_per_noncontact_pct','onground_per_contact_pct','inair_per_contact_pct','iffb_per_inair_pct','noniffb_per_inair_pct','hr_per_noniffb_pct','nonhr_per_noniffb_pct','ld_per_nonhr_pct','fb_per_nonhr_pct','out_per_ld_pct','nonout_per_ld_pct','single_per_nonoutl_pct','xb_per_nonoutl_pct','out_per_fb_pct','nonout_per_fb_pct','single_per_nonoutf_pct','xb_per_nonoutf_pct','out_per_onground_pct','nonout_per_onground_pct','single_per_nonoutg_pct','xb_per_nonoutg_pct','double_per_xb_g','double_per_xb_f','double_per_xb_l' UNION select lower(concat(b.nameFirst,' ',b.nameLast)) AS name,a.resp_bat_ID AS retroid,sum(if(a.event_cd=16,1,0))/count(a.event_cd) AS hbp_pct,sum(if(a.event_cd<>16,1,0))/count(a.event_cd) AS nonhbp_pct,sum(if(a.event_cd=3 OR a.event_cd=14 OR a.event_cd=15,1,0))/sum(if(a.event_cd<>16,1,0)) AS noncontact_per_nonhbp_pct,sum(if(a.event_cd<>3 AND a.event_cd<>14 AND a.event_cd<>15,1,0))/sum(if(a.event_cd<>16,1,0)) AS contact_per_nonhbp_pct,sum(if(a.event_cd=3,1,0))/sum(if(a.event_cd=3 or a.event_cd=14,1,0)) AS K_per_noncontact_pct,sum(if(a.event_cd=14,1,0))/sum(if(a.event_cd=3 or a.event_cd=14,1,0)) AS bb_per_noncontact_pct,sum(if(a.battedball_cd='G',1,0))/sum(if(a.battedball_cd<>'',1,0)) AS onground_per_contact_pct,sum(if(a.battedball_cd<>'G' and a.battedball_cd<>'',1,0))/sum(if(a.battedball_cd<>'',1,0)) AS inair_per_contact_pct,sum(if(a.battedball_cd='P',1,0))/sum(if(a.battedball_cd<>'' and a.battedball_cd<>'G',1,0)) AS iffb_per_inair_pct,sum(if(a.battedball_cd='L' or a.battedball_cd='F',1,0))/sum(if(a.battedball_cd<>'' and a.battedball_cd<>'G',1,0)) AS noniffb_per_inair_pct,sum(if(a.event_cd=23 AND (a.battedball_cd='F' OR a.battedball_cd='L'),1,0))/sum(if(a.battedball_cd='F' or a.battedball_cd='L',1,0)) AS hr_per_noniffb_pct,sum(if(a.event_cd<>23 AND (a.battedball_cd='F' OR a.battedball_cd='L'),1,0))/sum(if(a.battedball_cd='F' or a.battedball_cd='L',1,0)) AS nonhr_per_noniffb_pct,sum(if(a.battedball_cd='L' AND a.event_cd<>23,1,0))/sum(if(a.event_cd<>23 AND (a.battedball_cd='L' OR a.battedball_cd='F'),1,0)) AS ld_per_nonhr_pct,sum(if(a.battedball_cd='F' AND a.event_cd<>23,1,0))/sum(if(a.event_cd<>23 AND (a.battedball_cd='L' OR a.battedball_cd='F'),1,0)) AS fb_per_nonhr_pct,sum(if(a.event_cd<20 AND a.battedball_cd='L',1,0))/sum(if(a.battedball_cd='L' AND a.event_cd<>23,1,0)) AS out_per_ld_pct,sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='L',1,0))/sum(if(a.battedball_cd='L' AND a.event_cd<>23,1,0)) AS nonout_per_ld_pct,sum(if(a.event_cd=20 AND a.battedball_cd='L',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='L',1,0)) AS single_per_nonoutl_pct,sum(if((a.event_cd=21 or a.event_cd=22) AND a.battedball_cd='L',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='L',1,0)) AS xb_per_nonoutl_pct,sum(if(a.event_cd<20 AND a.battedball_cd='F',1,0))/sum(if(a.battedball_cd='F' AND a.event_cd<>23,1,0)) AS out_per_fb_pct,sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='F',1,0))/sum(if(a.battedball_cd='F' AND a.event_cd<>23,1,0)) AS nonout_per_fb_pct,sum(if(a.event_cd=20 AND a.battedball_cd='F',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='f',1,0)) AS single_per_nonoutf_pct,sum(if((a.event_cd=21 or a.event_cd=22) AND a.battedball_cd='F',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='F',1,0)) AS xb_per_nonoutf_pct,sum(if(a.event_cd<20 AND a.battedball_cd='G',1,0))/sum(if(a.battedball_cd='G',1,0)) AS out_per_onground_pct,sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='G',1,0))/sum(if(a.battedball_cd='G',1,0)) AS nonout_per_onground_pct,sum(if(a.event_cd=20 AND a.battedball_cd='G',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='G',1,0)) AS single_per_nonoutg_pct,sum(if((a.event_cd=21 or a.event_cd=22) AND a.battedball_cd='G',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='G',1,0)) AS xb_per_nonoutg_pct,sum(if(a.event_cd=21 AND a.battedball_cd='G',1,0))/sum(if((a.event_cd=21 or a.event_cd=22) AND a.battedball_cd='G',1,0)) AS double_per_xb_g,sum(if(a.event_cd=21 AND a.battedball_cd='F',1,0))/sum(if((a.event_cd=21 or a.event_cd=22) AND a.battedball_cd='F',1,0)) AS double_per_xb_f,sum(if(a.event_cd=21 AND a.battedball_cd='L',1,0))/sum(if((a.event_cd=21 or a.event_cd=22) AND a.battedball_cd='L',1,0)) AS double_per_xb_l from events_regseason a left join master_new_retro_ids b on a.resp_bat_id = b.retroid where a.year_ID = %s	AND a.bat_event_fl='T' AND a.bunt_fl<>'T' AND a.foul_fl<>'T' AND a.event_cd<>15 group by retroid INTO OUTFILE 'data/%s.csv' FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'")
	cursor.execute(query % (str(year), str(year)+"b"))
	
for year in range(2013,2014):
	cnx = mysql.connector.connect(user='root',password='Louis and Marie',database='baseball')
	cursor = cnx.cursor()
	query = ("select 'name','retroid','hbp_pct','nonhbp_pct','noncontact_per_nonhbp_pct','contact_per_nonhbp_pct','K_per_noncontact_pct','bb_per_noncontact_pct','onground_per_contact_pct','inair_per_contact_pct','iffb_per_inair_pct','noniffb_per_inair_pct','hr_per_noniffb_pct','nonhr_per_noniffb_pct','ld_per_nonhr_pct','fb_per_nonhr_pct','out_per_ld_pct','nonout_per_ld_pct','single_per_nonoutl_pct','xb_per_nonoutl_pct','out_per_fb_pct','nonout_per_fb_pct','single_per_nonoutf_pct','xb_per_nonoutf_pct','out_per_onground_pct','nonout_per_onground_pct','single_per_nonoutg_pct','xb_per_nonoutg_pct' UNION select lower(concat(b.nameFirst,' ',b.nameLast)) AS name,a.res_pit_ID AS retroid,sum(if(a.event_cd=16,1,0))/count(a.event_cd) AS hbp_pct,sum(if(a.event_cd<>16,1,0))/count(a.event_cd) AS nonhbp_pct,sum(if(a.event_cd=3 OR a.event_cd=14 OR a.event_cd=15,1,0))/sum(if(a.event_cd<>16,1,0)) AS noncontact_per_nonhbp_pct,sum(if(a.event_cd<>3 AND a.event_cd<>14 AND a.event_cd<>15,1,0))/sum(if(a.event_cd<>16,1,0)) AS contact_per_nonhbp_pct,sum(if(a.event_cd=3,1,0))/sum(if(a.event_cd=3 or a.event_cd=14,1,0)) AS K_per_noncontact_pct,sum(if(a.event_cd=14,1,0))/sum(if(a.event_cd=3 or a.event_cd=14,1,0)) AS bb_per_noncontact_pct,sum(if(a.battedball_cd='G',1,0))/sum(if(a.battedball_cd<>'',1,0)) AS onground_per_contact_pct,sum(if(a.battedball_cd<>'G' and a.battedball_cd<>'',1,0))/sum(if(a.battedball_cd<>'',1,0)) AS inair_per_contact_pct,sum(if(a.battedball_cd='P',1,0))/sum(if(a.battedball_cd<>'' and a.battedball_cd<>'G',1,0)) AS iffb_per_inair_pct,sum(if(a.battedball_cd='L' or a.battedball_cd='F',1,0))/sum(if(a.battedball_cd<>'' and a.battedball_cd<>'G',1,0)) AS noniffb_per_inair_pct,sum(if(a.event_cd=23 AND (a.battedball_cd='F' OR a.battedball_cd='L'),1,0))/sum(if(a.battedball_cd='F' or a.battedball_cd='L',1,0)) AS hr_per_noniffb_pct,sum(if(a.event_cd<>23 AND (a.battedball_cd='F' OR a.battedball_cd='L'),1,0))/sum(if(a.battedball_cd='F' or a.battedball_cd='L',1,0)) AS nonhr_per_noniffb_pct,sum(if(a.battedball_cd='L' AND a.event_cd<>23,1,0))/sum(if(a.event_cd<>23 AND (a.battedball_cd='L' OR a.battedball_cd='F'),1,0)) AS ld_per_nonhr_pct,sum(if(a.battedball_cd='F' AND a.event_cd<>23,1,0))/sum(if(a.event_cd<>23 AND (a.battedball_cd='L' OR a.battedball_cd='F'),1,0)) AS fb_per_nonhr_pct,sum(if(a.event_cd<20 AND a.battedball_cd='L',1,0))/sum(if(a.battedball_cd='L' AND a.event_cd<>23,1,0)) AS out_per_ld_pct,sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='L',1,0))/sum(if(a.battedball_cd='L' AND a.event_cd<>23,1,0)) AS nonout_per_ld_pct,sum(if(a.event_cd=20 AND a.battedball_cd='L',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='L',1,0)) AS single_per_nonoutl_pct,sum(if((a.event_cd=21 or a.event_cd=22) AND a.battedball_cd='L',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='L',1,0)) AS xb_per_nonoutl_pct,sum(if(a.event_cd<20 AND a.battedball_cd='F',1,0))/sum(if(a.battedball_cd='F' AND a.event_cd<>23,1,0)) AS out_per_fb_pct,sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='F',1,0))/sum(if(a.battedball_cd='F' AND a.event_cd<>23,1,0)) AS nonout_per_fb_pct,sum(if(a.event_cd=20 AND a.battedball_cd='F',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='f',1,0)) AS single_per_nonoutf_pct,sum(if((a.event_cd=21 or a.event_cd=22) AND a.battedball_cd='F',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='F',1,0)) AS xb_per_nonoutf_pct,sum(if(a.event_cd<20 AND a.battedball_cd='G',1,0))/sum(if(a.battedball_cd='G',1,0)) AS out_per_onground_pct,sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='G',1,0))/sum(if(a.battedball_cd='G',1,0)) AS nonout_per_onground_pct,sum(if(a.event_cd=20 AND a.battedball_cd='G',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='G',1,0)) AS single_per_nonoutg_pct,sum(if((a.event_cd=21 or a.event_cd=22) AND a.battedball_cd='G',1,0))/sum(if(a.event_cd>19 AND a.event_cd<23 AND a.battedball_cd='G',1,0)) AS xb_per_nonoutg_pct from events_regseason a left join master_new_retro_ids b on a.res_pit_id = b.retroid where a.year_ID = %s	AND a.bat_lineup_id <> 1 AND a.bat_event_fl='T' AND a.bunt_fl<>'T' AND a.foul_fl<>'T' AND a.event_cd<>15 group by retroid INTO OUTFILE 'data/%s.csv' FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'")
	cursor.execute(query % (str(year), str(year)+"p"))