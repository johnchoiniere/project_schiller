import mysql.connector

for year in range(1974,2014):
	cnx = mysql.connector.connect(user='root',password='Louis and Marie',database='baseball')
	cursor = cnx.cursor()
	query = ("select 'year','hbp_pct','nonhbp_pct','noncontact_per_nonhbp_pct','contact_per_nonhbp_pct','K_per_noncontact_pct','bb_per_noncontact_pct','onground_per_contact_pct','inair_per_contact_pct','iffb_per_inair_pct','noniffb_per_inair_pct','hr_per_noniffb_pct','nonhr_per_noniffb_pct','ld_per_nonhr_pct','fb_per_nonhr_pct','out_per_ld_pct','nonout_per_ld_pct','single_per_nonoutl_pct','xb_per_nonoutl_pct','out_per_fb_pct','nonout_per_fb_pct','single_per_nonoutf_pct','xb_per_nonoutf_pct','out_per_onground_pct','nonout_per_onground_pct','single_per_nonoutg_pct','xb_per_nonoutg_pct' UNION select year_ID as year,sum(if(event_cd=16,1,0))/count(event_cd) AS hbp_pct,sum(if(event_cd<>16,1,0))/count(event_cd) AS nonhbp_pct,sum(if(event_cd=3 OR event_cd=14 OR event_cd=15,1,0))/sum(if(event_cd<>16,1,0)) AS noncontact_per_nonhbp_pct,sum(if(event_cd<>3 AND event_cd<>14 AND event_cd<>15,1,0))/sum(if(event_cd<>16,1,0)) AS contact_per_nonhbp_pct,sum(if(event_cd=3,1,0))/sum(if(event_cd=3 or event_cd=14,1,0)) AS K_per_noncontact_pct,sum(if(event_cd=14,1,0))/sum(if(event_cd=3 or event_cd=14,1,0)) AS bb_per_noncontact_pct,sum(if(battedball_cd='G',1,0))/sum(if(battedball_cd<>'',1,0)) AS onground_per_contact_pct,sum(if(battedball_cd<>'G' and battedball_cd<>'',1,0))/sum(if(battedball_cd<>'',1,0)) AS inair_per_contact_pct,sum(if(battedball_cd='P',1,0))/sum(if(battedball_cd<>'' and battedball_cd<>'G',1,0)) AS iffb_per_inair_pct,sum(if(battedball_cd='L' or battedball_cd='F',1,0))/sum(if(battedball_cd<>'' and battedball_cd<>'G',1,0)) AS noniffb_per_inair_pct,sum(if(event_cd=23 AND (battedball_cd='F' OR battedball_cd='L'),1,0))/sum(if(battedball_cd='F' or battedball_cd='L',1,0)) AS hr_per_noniffb_pct,sum(if(event_cd<>23 AND (battedball_cd='F' OR battedball_cd='L'),1,0))/sum(if(battedball_cd='F' or battedball_cd='L',1,0)) AS nonhr_per_noniffb_pct,sum(if(battedball_cd='L' AND event_cd<>23,1,0))/sum(if(event_cd<>23 AND (battedball_cd='L' OR battedball_cd='F'),1,0)) AS ld_per_nonhr_pct,sum(if(battedball_cd='F' AND event_cd<>23,1,0))/sum(if(event_cd<>23 AND (battedball_cd='L' OR battedball_cd='F'),1,0)) AS fb_per_nonhr_pct,sum(if(event_cd<20 AND battedball_cd='L',1,0))/sum(if(battedball_cd='L' AND event_cd<>23,1,0)) AS out_per_ld_pct,sum(if(event_cd>19 AND event_cd<23 AND battedball_cd='L',1,0))/sum(if(battedball_cd='L' AND event_cd<>23,1,0)) AS nonout_per_ld_pct,sum(if(event_cd=20 AND battedball_cd='L',1,0))/sum(if(event_cd>19 AND event_cd<23 AND battedball_cd='L',1,0)) AS single_per_nonoutl_pct,sum(if((event_cd=21 or event_cd=22) AND battedball_cd='L',1,0))/sum(if(event_cd>19 AND event_cd<23 AND battedball_cd='L',1,0)) AS xb_per_nonoutl_pct,sum(if(event_cd<20 AND battedball_cd='F',1,0))/sum(if(battedball_cd='F' AND event_cd<>23,1,0)) AS out_per_fb_pct,sum(if(event_cd>19 AND event_cd<23 AND battedball_cd='F',1,0))/sum(if(battedball_cd='F' AND event_cd<>23,1,0)) AS nonout_per_fb_pct,sum(if(event_cd=20 AND battedball_cd='F',1,0))/sum(if(event_cd>19 AND event_cd<23 AND battedball_cd='f',1,0)) AS single_per_nonoutf_pct,sum(if((event_cd=21 or event_cd=22) AND battedball_cd='F',1,0))/sum(if(event_cd>19 AND event_cd<23 AND battedball_cd='F',1,0)) AS xb_per_nonoutf_pct,sum(if(event_cd<20 AND battedball_cd='G',1,0))/sum(if(battedball_cd='G',1,0)) AS out_per_onground_pct,sum(if(event_cd>19 AND event_cd<23 AND battedball_cd='G',1,0))/sum(if(battedball_cd='G',1,0)) AS nonout_per_onground_pct,sum(if(event_cd=20 AND battedball_cd='G',1,0))/sum(if(event_cd>19 AND event_cd<23 AND battedball_cd='G',1,0)) AS single_per_nonoutg_pct,sum(if((event_cd=21 or event_cd=22) AND battedball_cd='G',1,0))/sum(if(event_cd>19 AND event_cd<23 AND battedball_cd='G',1,0)) AS xb_per_nonoutg_pct from events_regseason where year_ID = %s AND bat_lineup_id <> 1 AND bat_event_fl='T' AND bunt_fl<>'T' AND foul_fl<>'T' AND event_cd<>15 INTO OUTFILE 'data/%s.csv' FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'")
	cursor.execute(query % (str(year), str(year)+"mlb"))